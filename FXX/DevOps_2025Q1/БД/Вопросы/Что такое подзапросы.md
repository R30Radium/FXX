
**Подзапросы (Subqueries)** в SQL — это запросы, вложенные внутри других запросов. Они используются для выполнения промежуточных вычислений или фильтрации данных перед выполнением основного запроса. Подзапросы могут возвращать:
- Одно значение (скалярный подзапрос).
- Несколько строк и столбцов (табличный подзапрос).

---

### Типы подзапросов:
1. **Скалярный подзапрос**:
   - Возвращает одно значение (одну строку и один столбец).
   - Используется в выражениях, например, в `SELECT`, `WHERE`, `HAVING`.

   **Пример**:
   ```sql
   SELECT name, (SELECT MAX(salary) FROM employees) AS max_salary
   FROM employees;
   ```

2. **Подзапрос в `WHERE`**:
   - Используется для фильтрации данных на основе результата другого запроса.

   **Пример**:
   ```sql
   SELECT name
   FROM employees
   WHERE salary > (SELECT AVG(salary) FROM employees);
   ```

3. **Подзапрос в `FROM`**:
   - Возвращает таблицу, которая используется как временная таблица в основном запросе.

   **Пример**:
   ```sql
   SELECT avg_salary
   FROM (SELECT AVG(salary) AS avg_salary FROM employees) AS temp_table;
   ```

4. **Подзапрос в `SELECT`**:
   - Возвращает значение для каждой строки основного запроса.

   **Пример**:
   ```sql
   SELECT name, (SELECT department_name FROM departments WHERE id = employees.department_id) AS department
   FROM employees;
   ```

5. **Коррелированный подзапрос**:
   - Подзапрос, который зависит от данных из внешнего запроса.

   **Пример**:
   ```sql
   SELECT name
   FROM employees e
   WHERE salary > (SELECT AVG(salary) FROM employees WHERE department_id = e.department_id);
   ```

---

### Преимущества подзапросов:
- Позволяют разбивать сложные задачи на более простые.
- Упрощают чтение и поддержку кода.
- Могут использоваться в любом месте SQL-запроса.

---

### Итог:
Подзапросы — это мощный инструмент для выполнения промежуточных вычислений или фильтрации данных внутри SQL-запросов. Они могут быть скалярными, табличными или коррелированными, в зависимости от задачи.