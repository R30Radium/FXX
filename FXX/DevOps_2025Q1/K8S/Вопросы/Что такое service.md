
### **Коротко:**
**Сервис (Service)** в Kubernetes — это абстракция, которая обеспечивает **стабильный доступ** к приложениям, работающим в подах. Он предоставляет постоянный IP-адрес и DNS-имя, даже если поды перезапускаются или перемещаются.

---

### **Подробно:**

#### **1. Что такое сервис:**
- Сервис — это способ **обнаружения** и **доступа** к приложениям, работающим в кластере.
- Он абстрагирует доступ к подам, скрывая их IP-адреса и обеспечивая стабильную точку входа.

---

#### **2. Зачем нужен сервис:**
- **Стабильность:** Поды могут перезапускаться или перемещаться, но сервис предоставляет постоянный IP и DNS.
- **Балансировка нагрузки:** Сервис распределяет трафик между всеми подами, которые соответствуют его селектору.
- **Обнаружение сервисов:** Сервисы могут быть доступны по DNS-имени внутри кластера.

---

#### **3. Типы сервисов:**

##### **ClusterIP:**
- **По умолчанию.**
- Предоставляет внутренний IP-адрес, доступный только внутри кластера.
- Пример:
  ```yaml
  apiVersion: v1
  kind: Service
  metadata:
    name: my-service
  spec:
    selector:
      app: my-app
    ports:
    - protocol: TCP
      port: 80
      targetPort: 8080
  ```

##### **NodePort:**
- Открывает порт на каждой ноде кластера, чтобы приложение было доступно снаружи.
- Пример:
  ```yaml
  apiVersion: v1
  kind: Service
  metadata:
    name: my-service
  spec:
    type: NodePort
    selector:
      app: my-app
    ports:
    - protocol: TCP
      port: 80
      targetPort: 8080
      nodePort: 30007
  ```

##### **LoadBalancer:**
- Создаёт внешний балансировщик нагрузки (например, в облачных провайдерах).
- Пример:
  ```yaml
  apiVersion: v1
  kind: Service
  metadata:
    name: my-service
  spec:
    type: LoadBalancer
    selector:
      app: my-app
    ports:
    - protocol: TCP
      port: 80
      targetPort: 8080
  ```

##### **ExternalName:**
- Сопоставляет сервис с внешним DNS-именем (например, для доступа к внешним сервисам).
- Пример:
  ```yaml
  apiVersion: v1
  kind: Service
  metadata:
    name: my-service
  spec:
    type: ExternalName
    externalName: my.database.example.com
  ```

---

#### **4. Как работает сервис:**
- Сервис использует **селектор** для поиска подов, которые он должен "обслуживать".
- Он создаёт **эндпоинты** (endpoints), которые указывают на IP-адреса подов.
- Трафик распределяется между подами через **kube-proxy**.

---

#### **5. Пример использования:**
- **ClusterIP:** Для внутреннего доступа к приложениям.
- **NodePort:** Для тестирования или доступа снаружи в локальных кластерах.
- **LoadBalancer:** Для production-сред в облачных провайдерах.
- **ExternalName:** Для интеграции с внешними сервисами.

---

#### **6. Пример манифеста сервиса:**
```yaml
apiVersion: v1
kind: Service
metadata:
  name: web-service
spec:
  selector:
    app: web-app
  ports:
  - protocol: TCP
    port: 80
    targetPort: 8080
  type: ClusterIP
```

---

**Сервис** — это ключевой компонент Kubernetes для обеспечения стабильного доступа к приложениям и балансировки нагрузки.